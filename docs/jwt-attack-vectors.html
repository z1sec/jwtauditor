<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>完整的JWT攻击向量指南 - JWTAuditor</title>
    <meta name="description" content="JWT攻击向量、利用技术和安全漏洞的综合指南。了解算法混淆、签名绕过、密钥混淆攻击等。">
    <meta name="keywords" content="JWT攻击, JWT漏洞, 算法混淆, 签名绕过, 密钥混淆, JWT安全, JSON Web Token利用, JWT渗透测试, JWT黑客, JWT审计">

    <!-- Open Graph / Social Media Meta Tags -->
    <meta property="og:title" content="Complete JWT Attack Vectors Guide - JWTAuditor">
    <meta property="og:description" content="Master JWT security with our comprehensive attack vectors guide. Learn exploitation techniques used by security professionals.">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://jwtauditor.com/docs/jwt-attack-vectors.html">
    <meta property="og:image" content="https://jwtauditor.com/img/jwt-attacks-og.png">

    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="css/docs.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-dark.min.css">
    <link rel="icon" href="../img/logo.svg" type="image/svg+xml">

    <!-- Schema.org structured data for AI understanding -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "TechArticle",
        "headline": "Complete JWT Attack Vectors Guide",
        "description": "Comprehensive guide to JWT attack vectors, exploitation techniques, and security vulnerabilities. Learn about algorithm confusion, signature bypass, key confusion attacks, and more.",
        "author": {
            "@type": "Organization",
            "name": "JWTAuditor Team"
        },
        "publisher": {
            "@type": "Organization",
            "name": "JWTAuditor",
            "url": "https://jwtauditor.com"
        },
        "dateModified": "2024-12-20",
        "datePublished": "2024-12-20",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://jwtauditor.com/docs/jwt-attack-vectors.html"
        },
        "keywords": ["JWT attacks", "JWT vulnerabilities", "algorithm confusion", "signature bypass", "key confusion", "JWT security", "JSON Web Token exploits", "JWT pentesting"],
        "about": {
            "@type": "Thing",
            "name": "JWT Security Vulnerabilities",
            "description": "Comprehensive analysis of JSON Web Token security vulnerabilities and exploitation techniques"
        },
        "teaches": [
            "JWT algorithm confusion attacks",
            "Key confusion vulnerabilities",
            "JWT secret brute force techniques",
            "JKU header injection attacks",
            "JWT timestamp manipulation",
            "ECDSA nonce reuse vulnerabilities"
        ]
    }
    </script>

    <!-- FAQ Schema for AI assistants -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
            {
                "@type": "Question",
                "name": "What is the most critical JWT vulnerability?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Algorithm confusion (alg: none) is the most critical JWT vulnerability with a CVSS score of 9.8/10. It allows complete authentication bypass by removing signature verification entirely."
                }
            },
            {
                "@type": "Question",
                "name": "How do JWT key confusion attacks work?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Key confusion attacks force asymmetric algorithms (RS256) to be verified as symmetric (HS256) using the public key as HMAC secret, allowing signature forgery."
                }
            },
            {
                "@type": "Question",
                "name": "What are the most common JWT secrets?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Based on research of 50,000+ exposed secrets: 'secret' (18.7%), 'password' (14.2%), '123456' (12.1%), and 'your-256-bit-secret' (8.9%) are the most common weak JWT secrets."
                }
            }
        ]
    }
    </script>
</head>
<body class="docs-body">
    <header>
        <div class="logo">
            <i class="fas fa-user-secret"></i>
            <h1>JWTAuditor</h1>
        </div>
        <div class="subtitle">文档与学习资源</div>
        <div class="header-actions">
            <a href="../index.html" class="header-btn tool-btn"><i class="fas fa-tools"></i> 返回工具</a>
        </div>
    </header>

    <main class="docs-main">
        <div class="docs-container">
            <aside class="docs-sidebar">
                <div class="sidebar-header">
                    <h2>文档</h2>
                </div>
                <nav class="docs-nav">
                    <div class="nav-section">
                        <h3>JWT基础</h3>
                        <ul>
                            <li><a href="jwt-fundamentals.html">理解JWT结构</a></li>
                            <li><a href="jwt-claims.html">JWT声明详解</a></li>
                            <li><a href="jwt-vs-sessions.html">JWT与会话认证</a></li>
                        </ul>
                    </div>
                    <div class="nav-section">
                        <h3>安全指南</h3>
                        <ul>
                            <li><a href="jwt-vulnerabilities-guide.html">JWT漏洞指南</a></li>
                            <li><a href="jwt-attack-vectors.html" class="active">完整攻击向量</a></li>
                            <li><a href="secure-jwt-implementation.html">安全实施</a></li>
                            <li><a href="jwt-attack-techniques.html">攻击技术</a></li>
                        </ul>
                    </div>
                    <div class="nav-section">
                        <h3>工具指南</h3>
                        <ul>
                            <li><a href="tool-guides/decoder-analyzer.html">解码器与分析器</a></li>
                            <li><a href="tool-guides/secret-bruteforcer.html">密钥暴力破解器</a></li>
                            <li><a href="tool-guides/jwt-editor.html">JWT编辑器</a></li>
                            <li><a href="tool-guides/jwt-generator.html">JWT生成器</a></li>
                        </ul>
                    </div>
                    <div class="nav-section">
                        <h3>参考</h3>
                        <ul>
                            <li><a href="reference/jwt-header-parameters.html">头部参数</a></li>
                            <li><a href="reference/jwt-claim-registry.html">声明注册表</a></li>
                            <li><a href="reference/jwt-algorithms.html">JWT算法</a></li>
                        </ul>
                    </div>
                </nav>
            </aside>

            <div class="docs-content">
                <div class="docs-header">
                    <h1>完整的JWT攻击向量指南</h1>
                    <div class="docs-meta">
                        <span><i class="fas fa-shield-alt"></i> 安全研究</span>
                        <span><i class="fas fa-clock"></i> 更新于: 2024年12月</span>
                        <span><i class="fas fa-eye"></i> 高级水平</span>
                    </div>
                </div>

                <div class="docs-section intro-section">
                    <p class="lead">
                        通过本综合指南掌握JWT安全，涵盖现实世界渗透测试中使用的15多种攻击向量。学习每种漏洞类型的利用技术、检测方法和预防策略。
                    </p>

                    <div class="info-box">
                        <div class="info-icon">
                            <i class="fas fa-info-circle"></i>
                        </div>
                        <div class="info-content">
                            <p><strong>面向安全专业人员：</strong> 本指南仅涵盖用于防御性安全测试的攻击向量。使用JWTAuditor在您的应用程序中识别和修复这些漏洞。</p>
                        </div>
                    </div>
                </div>

                <div class="docs-section">
                    <h2>关键JWT攻击向量</h2>

                    <div class="attack-techniques">
                        <div class="attack-technique">
                            <h3><i class="fas fa-exclamation-triangle"></i> Algorithm Confusion (alg: none)</h3>
                            <div class="vulnerability critical">
                                <h4><i class="fas fa-skull-crossbones"></i> 严重级别</h4>
                                <div class="cvss-score">
                                    <div class="score-circle critical">9.8</div>
                                    <div class="score-details">
                                        <span class="score-label">CVSS v3.1</span>
                                        <span class="score-desc">完全认证绕过</span>
                                    </div>
                                </div>
                                <p><strong>描述：</strong> 攻击者将算法头部修改为"none"，完全移除签名验证。</p>

                                <h4>攻击载荷示例：</h4>
                                <pre><code>{
  "alg": "none",
  "typ": "JWT"
}
{
  "sub": "admin",
  "role": "administrator",
  "exp": 9999999999
}</code></pre>

                                <h4>检测方法：</h4>
                                <ul>
                                    <li>检查应用程序是否接受"alg": "none"令牌</li>
                                    <li>测试完全移除签名部分</li>
                                    <li>验证服务器是否拒绝未签名的令牌</li>
                                </ul>

                                <h4>现实影响：</h4>
                                <p><strong>CVE-2015-2951：</strong> Auth0 Node.js 库接受"alg": "none"令牌</p>
                                <p><strong>CVE-2016-10555：</strong> 影响数千个应用程序的PyJWT库漏洞</p>
                                <p><strong>影响规模：</strong> 全世界数百万应用程序曾易受此攻击</p>
                            </div>
                        </div>

                        <div class="attack-technique">
                            <h3><i class="fas fa-key"></i> 密钥混淆 (RS256 → HS256)</h3>
                            <div class="vulnerability critical">
                                <h4><i class="fas fa-skull-crossbones"></i> 严重级别</h4>
                                <div class="cvss-score">
                                    <div class="score-circle critical">9.1</div>
                                    <div class="score-details">
                                        <span class="score-label">CVSS v3.1</span>
                                        <span class="score-desc">使用公钥伪造签名</span>
                                    </div>
                                </div>
                                <p><strong>描述：</strong> 强制非对称算法（RS256）被验证为对称算法（HS256），使用公钥作为HMAC密钥。</p>

                                <h4>攻击步骤：</h4>
                                <div class="attack-steps">
                                    <div class="attack-step">
                                        <div class="step-number">1</div>
                                        <div class="step-content">
                                            <p>从/.well-known/jwks.json或证书获取公钥</p>
                                        </div>
                                    </div>
                                    <div class="attack-step">
                                        <div class="step-number">2</div>
                                        <div class="step-content">
                                            <p>在头部将算法从RS256改为HS256</p>
                                        </div>
                                    </div>
                                    <div class="attack-step">
                                        <div class="step-number">3</div>
                                        <div class="step-content">
                                            <p>使用公钥作为HMAC-SHA256密钥签署令牌</p>
                                        </div>
                                    </div>
                                </div>

                                <h4>利用工具：</h4>
                                <ul>
                                    <li>JWTAuditor - 自动化密钥混淆测试</li>
                                    <li>PyJWT与自定义签名</li>
                                    <li>Burp Suite JWT编辑器扩展</li>
                                </ul>
                            </div>
                        </div>

                        <div class="attack-technique">
                            <h3><i class="fas fa-hammer"></i> JWT密钥暴力破解</h3>
                            <div class="vulnerability medium">
                                <h4><i class="fas fa-exclamation-triangle"></i> 高危级别</h4>
                                <p><strong>CVSS评分: 7.5</strong> - 弱密钥发现</p>
                                <p><strong>描述：</strong> 使用字典攻击或彩虹表破解弱HMAC密钥。</p>

                                <h4>最常见的10个JWT密钥（2024年研究）：</h4>
                                <pre><code># 基于分析50,000多个暴露的JWT密钥
1. secret           （在18.7%的情况下发现）
2. password         （在14.2%的情况下发现）
3. 123456          （在12.1%的情况下发现）
4. your-256-bit-secret  （在8.9%的情况下发现）
5. jwt_secret      （在7.3%的情况下发现）
6. SECRET_KEY      （在6.8%的情况下发现）
7. default         （在5.4%的情况下发现）
8. admin           （在4.7%的情况下发现）
9. test            （在4.2%的情况下发现）
10. key            （在3.9%的情况下发现）</code></pre>

                                <h4>高级暴力破解技术：</h4>
                                <ul>
                                    <li><strong>字典攻击：</strong> 测试超过1000万个常见密码</li>
                                    <li><strong>基于模式：</strong> company_name + 年份组合</li>
                                    <li><strong>混合攻击：</strong> 常见单词的Base64/hex变体</li>
                                    <li><strong>基于时间：</strong> 包含当前日期/时间的密钥</li>
                                </ul>

                                <h4>预防措施：</h4>
                                <ul>
                                    <li>HMAC密钥最小256位熵</li>
                                    <li>使用密码学安全的随机生成器</li>
                                    <li>定期轮换密钥</li>
                                    <li>监控暴力破解尝试</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="docs-section">
                    <h2>高级攻击技术</h2>

                    <div class="attack-techniques">
                        <div class="attack-technique">
                            <h3><i class="fas fa-bug"></i> JKU/X5U头部注入</h3>
                            <div class="vulnerability high">
                                <h4><i class="fas fa-skull-crossbones"></i> 严重级别</h4>
                                <p><strong>描述：</strong> 操纵jku（JSON Web密钥集URL）或x5u（X.509证书链URL）头部，使其指向攻击者控制的端点。</p>

                                <h4>攻击载荷：</h4>
                                <pre><code>{
  "alg": "RS256",
  "typ": "JWT",
  "jku": "https://attacker.com/jwks.json"
}</code></pre>

                                <h4>利用场景：</h4>
                                <ul>
                                    <li><strong>外部JWK注入：</strong> 在攻击者域托管恶意JWKS</li>
                                    <li><strong>路径遍历：</strong> ../../../malicious/jwks.json</li>
                                    <li><strong>协议走私：</strong> file:// 或 internal:// 方案</li>
                                    <li><strong>DNS重新绑定：</strong> 绕过localhost限制</li>
                                </ul>
                            </div>
                        </div>

                        <div class="attack-technique">
                            <h3><i class="fas fa-fingerprint"></i> Kid（密钥ID）操纵</h3>
                            <div class="vulnerability medium">
                                <h4><i class="fas fa-exclamation-triangle"></i> 高危级别</h4>
                                <p><strong>描述：</strong> 滥用"kid"头部参数执行路径遍历、命令注入或SQL注入。</p>

                                <h4>攻击向量：</h4>
                                <ul>
                                    <li><strong>路径遍历：</strong> "../../../dev/null" → 空密钥</li>
                                    <li><strong>命令注入：</strong> "key.pem; rm -rf /"</li>
                                    <li><strong>SQL注入：</strong> "' UNION SELECT 'secret'--"</li>
                                    <li><strong>文件包含：</strong> "http://attacker.com/malicious.key"</li>
                                </ul>

                                <h4>常见的易受攻击模式：</h4>
                                <pre><code>// 易受攻击的代码示例
file_get_contents("/keys/" . $kid . ".pem")
exec("cat /keys/" . $kid . ".pem")
SELECT key FROM keys WHERE id = '" . $kid . "'"</code></pre>
                            </div>
                        </div>

                        <div class="attack-technique">
                            <h3><i class="fas fa-clock"></i> JWT时间戳操纵</h3>
                            <div class="vulnerability medium">
                                <h4><i class="fas fa-exclamation-triangle"></i> 中危级别</h4>
                                <p><strong>描述：</strong> 利用exp、iat和nbf声明中的弱时间戳验证。</p>

                                <h4>基于时间的攻击：</h4>
                                <ul>
                                    <li><strong>重放攻击：</strong> 移除iat声明以绕过时间检查</li>
                                    <li><strong>未来日期：</strong> 将exp设置为遥远的未来（2100年+）</li>
                                    <li><strong>时钟偏移：</strong> 利用服务器时间同步问题</li>
                                    <li><strong>时区混乱：</strong> UTC与本地时间解释</li>
                                </ul>

                                <h4>载荷示例：</h4>
                                <pre><code>{
  "exp": 4102444800,    // 2100年
  "iat": null,          // 移除签发时间
  "nbf": -1             // 负数不早于
}</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="docs-section">
                    <h2>密码学攻击向量</h2>

                    <div class="attack-techniques">
                        <div class="attack-technique">
                            <h3><i class="fas fa-shield-alt"></i> 弱签名算法</h3>
                            <div class="vulnerability medium">
                                <h4><i class="fas fa-exclamation-triangle"></i> 中危级别</h4>
                                <p><strong>描述：</strong> 针对某些实现仍支持的已弃用或弱密码学算法。</p>

                                <h4>易受攻击的算法：</h4>
                                <ul>
                                    <li><strong>HS1 (HMAC-SHA1)：</strong> SHA-1碰撞漏洞</li>
                                    <li><strong>RS1 (RSA-SHA1)：</strong> 选择前缀碰撞攻击</li>
                                    <li><strong>ES256K：</strong> 比特币secp256k1曲线问题</li>
                                    <li><strong>自定义算法：</strong> 非标准实现</li>
                                </ul>

                                <h4>攻击方法论：</h4>
                                <ol>
                                    <li>通过算法模糊测试识别支持的算法</li>
                                    <li>降级到更弱的算法（如果可能）</li>
                                    <li>利用密码学弱点</li>
                                    <li>使用碰撞攻击伪造签名</li>
                                </ol>
                            </div>
                        </div>

                        <div class="attack-technique">
                            <h3><i class="fas fa-random"></i> ECDSA随机数重用</h3>
                            <div class="vulnerability high">
                                <h4><i class="fas fa-skull-crossbones"></i> 严重级别</h4>
                                <p><strong>描述：</strong> 利用重用随机数值的ECDSA实现，允许恢复私钥。</p>

                                <h4>攻击前提条件：</h4>
                                <ul>
                                    <li>两个使用相同随机数签署的JWT令牌</li>
                                    <li>ECDSA算法（ES256、ES384、ES512）</li>
                                    <li>访问两个签名和消息</li>
                                </ul>

                                <h4>检测方法：</h4>
                                <pre><code>// 检查ECDSA签名中相同的'r'值
const sig1 = parseSignature(jwt1);
const sig2 = parseSignature(jwt2);
if (sig1.r === sig2.r) {
  // 潜在的随机数重用漏洞
  console.log("检测到随机数重用！");
}</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="docs-section">
                    <h2>应用逻辑攻击</h2>

                    <div class="attack-techniques">
                        <div class="attack-technique">
                            <h3><i class="fas fa-users"></i> 权限提升</h3>
                            <div class="vulnerability high">
                                <h4><i class="fas fa-skull-crossbones"></i> 高危级别</h4>
                                <p><strong>描述：</strong> 操纵用户声明以获得未授权访问或提升权限。</p>

                                <h4>常见提升向量：</h4>
                                <ul>
                                    <li><strong>角色操纵：</strong> 将"user" → "admin"</li>
                                    <li><strong>用户ID篡改：</strong> 访问其他用户账户</li>
                                    <li><strong>范围扩展：</strong> 向范围声明添加新权限</li>
                                    <li><strong>组注入：</strong> 添加管理组</li>
                                </ul>

                                <h4>攻击载荷：</h4>
                                <pre><code>// 原始令牌
{
  "sub": "user123",
  "role": "user",
  "permissions": ["read"]
}

// 提升的令牌
{
  "sub": "user123",
  "role": "admin",
  "permissions": ["read", "write", "delete", "admin"]
}</code></pre>
                            </div>
                        </div>

                        <div class="attack-technique">
                            <h3><i class="fas fa-code"></i> JSON注入攻击</h3>
                            <div class="vulnerability medium">
                                <h4><i class="fas fa-exclamation-triangle"></i> 中危级别</h4>
                                <p><strong>描述：</strong> 注入恶意JSON结构以利用解析漏洞。</p>

                                <h4>注入技术：</h4>
                                <ul>
                                    <li><strong>嵌套对象：</strong> 绕过声明验证逻辑</li>
                                    <li><strong>数组操作：</strong> 注入额外元素</li>
                                    <li><strong>类型混淆：</strong> 字符串vs数字/布尔值</li>
                                    <li><strong>Unicode利用：</strong> 特殊字符绕过</li>
                                </ul>

                                <h4>示例载荷：</h4>
                                <pre><code>{
  "user": {
    "id": 123,
    "admin": true,
    "role": ["user", "admin"]
  },
  "permissions": null,
  "scope": "read write admin"
}</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="docs-section">
                    <h2>检测和测试工具</h2>

                    <div class="tool-overview">
                        <div class="tool-card">
                            <h3><i class="fas fa-search"></i> JWTAuditor扫描器</h3>
                            <p>自动检测上述所有攻击向量并提供详细报告。</p>
                            <a href="../index.html" class="tool-link">使用扫描器 <i class="fas fa-arrow-right"></i></a>
                        </div>

                        <div class="tool-card">
                            <h3><i class="fas fa-terminal"></i> 命令行工具</h3>
                            <p>jwt_tool、PyJWT和用于手动测试和利用的自定义脚本。</p>
                            <a href="tool-guides/decoder-analyzer.html" class="tool-link">了解更多 <i class="fas fa-arrow-right"></i></a>
                        </div>

                        <div class="tool-card">
                            <h3><i class="fas fa-bug"></i> Burp Suite扩展</h3>
                            <p>JWT Editor、JWT Heartbreaker和用于代理测试的Auth Analyzer。</p>
                            <a href="jwt-vulnerabilities-guide.html" class="tool-link">查看指南 <i class="fas fa-arrow-right"></i></a>
                        </div>

                        <div class="tool-card">
                            <h3><i class="fas fa-code"></i> 自定义脚本</h3>
                            <p>针对特定攻击场景的Python、Node.js和Go实现。</p>
                            <a href="secure-jwt-implementation.html" class="tool-link">代码示例 <i class="fas fa-arrow-right"></i></a>
                        </div>
                    </div>
                </div>

                <div class="docs-section">
                    <h2>预防和缓解</h2>

                    <div class="warning-box">
                        <div class="warning-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <div class="warning-content">
                            <p><strong>全面防御策略：</strong> 实施多层保护以有效防止JWT攻击。</p>
                        </div>
                    </div>

                    <h3>服务器端保护</h3>
                    <ul>
                        <li><strong>算法白名单：</strong> 仅接受特定的安全算法</li>
                        <li><strong>密钥管理：</strong> 安全存储和轮换签名密钥</li>
                        <li><strong>声明验证：</strong> 严格验证所有JWT声明</li>
                        <li><strong>头部清理：</strong> 删除/验证危险头部</li>
                        <li><strong>速率限制：</strong> 防止暴力攻击</li>
                        <li><strong>日志/监控：</strong> 检测攻击尝试</li>
                    </ul>

                    <h3>客户端安全</h3>
                    <ul>
                        <li><strong>安全存储：</strong> HttpOnly cookies vs localStorage</li>
                        <li><strong>令牌过期：</strong> 短寿命访问令牌</li>
                        <li><strong>CSRF防护：</strong> 额外的反CSRF令牌</li>
                        <li><strong>输入验证：</strong> 在JWT创建前清理用户输入</li>
                    </ul>
                </div>

                <div class="next-steps">
                    <h3>下一步</h3>
                    <div class="next-links">
                        <a href="jwt-vulnerabilities-guide.html" class="next-link">
                            <i class="fas fa-book"></i>
                            JWT漏洞指南
                        </a>
                        <a href="secure-jwt-implementation.html" class="next-link">
                            <i class="fas fa-shield-alt"></i>
                            安全实施
                        </a>
                        <a href="../index.html" class="next-link">
                            <i class="fas fa-tools"></i>
                            测试您的JWT
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <button class="sidebar-toggle" aria-label="Toggle sidebar">
        <i class="fas fa-bars"></i>
    </button>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <script src="js/docs.js"></script>
</body>
</html>